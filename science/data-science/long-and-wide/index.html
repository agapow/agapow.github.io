<!doctype html>
<html lang="">
<head>
	<meta charset="utf-8"/>
	<title>Long and wide matrices - Make More Machines</title>
	<meta name="author" content="Paul Agapow">


  <meta name="description" content="There are two broad ways data can be stored in a matrix. In "wide" format, everything for a given subject / record is on a single line / row. For example: patientId control_cells control_temp drugA_cells drugA_temp drugB_cells drugB_temp 1 ... 2 ... ... Whereas the "long" format has multiple rows for a subject, one for …">

	<meta name="twitter:card" content="summary">
	  <meta name="twitter:creator" content="@agapow">
	<meta name="twitter:title" content="Long and wide matrices">
	<meta name="twitter:description" content="There are two broad ways data can be stored in a matrix. In "wide" format, everything for a given subject / record is on a single line / row. For example: patientId control_cells control_temp drugA_cells drugA_temp drugB_cells drugB_temp 1 ... 2 ... ... Whereas the "long" format has multiple rows for a subject, one for …">
	<meta name="twitter:url" content="/science/data-science/long-and-wide/">


	<link rel="stylesheet" href="/theme/css/main.css" type="text/css" />



</head>

<body>

    <div class="container">

	  <header role="banner">
	    <div class="feeds">
	    </div>
	      <nav class="pages">
			  <a href="/about">About</a>
-			  <a href="/whereabouts">Whereabouts</a>
	      </nav>
		<a href="" class="title">Make More Machines</a>&nbsp;&nbsp;(agapow.net)
      </header>

	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">

		<h1>Long and wide matrices</h1>

<div class="metadata">
  <time datetime="2017-07-13T00:00:00+01:00" pubdate>2017-07-13</time>
    <address class="vcard author">
      by <a class="url fn" href="/False">Paul Agapow</a>
    </address>
  in <a href="/science/">science</a>
<p class="tags">tagged <a href="//by-tag/programming/">programming</a>, <a href="//by-tag/r/">r</a></p></div>
		<div class="summary">A quick lesson on representing data and reshaping matrices</div>


      <p>There are two broad ways data can be stored in a matrix. In "wide" format,
everything for a given subject / record is on a single line / row. For
example:</p>
<div class="highlight"><pre><span></span>patientId   control_cells   control_temp   drugA_cells   drugA_temp   drugB_cells   drugB_temp
1           ...
2           ...
...
</pre></div>


<p>Whereas the "long" format has multiple rows for a subject, one for each condition.
For example:</p>
<div class="highlight"><pre><span></span>patientId   treatment   cells   temp
1           control     ...
1           drugA       ...
1           drugB       ...
2           control     ...
...
</pre></div>


<p>Wide is generally more useful than long. (It's a good rule of thumb to have a
record per line, although what you consider to be a record may vary.) So how do
you convert between the two? Easy. First, let's make a long matrix::</p>
<p>Note the row / subject id has to be a factor::</p>
<div class="highlight"><pre><span></span>long_df<span class="o">$</span>patientId <span class="o">&lt;-</span> factor <span class="p">(</span>long_df<span class="o">$</span>patientId<span class="p">)</span>
</pre></div>


<p>And use "recast" from the "reshape2" library. The parameters are:</p>
<ul>
<li>the dataframe (don't know if this works with a matrix, may have to cast)</li>
<li>a formula showing how the data is grouped, '...' means 'everything else'</li>
</ul>
<p>This assumes that everything else is a measurement column. Columns will be named appropriately:</p>
<div class="highlight"><pre><span></span><span class="kn">library</span> <span class="p">(</span>reshape2<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Error in library(reshape2): there is no package called &#39;reshape2&#39;
</pre></div>


<div class="highlight"><pre><span></span>wide_df <span class="o">&lt;-</span> recast <span class="p">(</span>long_df<span class="p">,</span> patientId <span class="o">~</span> treatment <span class="o">+</span> <span class="kc">...</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Error in recast(long_df, patientId ~ treatment + ...): could not find function &quot;recast&quot;
</pre></div>


<div class="highlight"><pre><span></span>print <span class="p">(</span>wide_df<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Error in print(wide_df): object &#39;wide_df&#39; not found
</pre></div>


<div class="highlight"><pre><span></span>print <span class="p">(</span>colnames <span class="p">(</span>wide_df<span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>## Error in is.data.frame(x): object &#39;wide_df&#39; not found
</pre></div>


<p>Now this is just the barebones of <code>recast</code> and there are lots of options and possibilities. There are also several other libraries (notably <code>tidyr</code>) that can also make this conversion and are arguably more powerful. However, to my eye they're much more complicated. For simple cases, the above works just fine. Note that many of the examples scattered across the web also assume there's only one measurement column.</p>

	</article>

    <p>
	<a href="https://twitter.com/share" class="twitter-share-button" data-via="" data-lang="en" data-size="large" data-related="">Tweet</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	</p>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'agapow';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

		  </div>

		  <div class="sidebar">
		    <div class="sidebar-container" >


	            <aside>
	              <h2>About</h2>
			      <p class='summary'>
                  This site has just been restored, with most of the content
						translated automatically from its old form. Expect bugs,
						missing information and general wierdness as things
						get sorted out.
			      </p>
			    </aside>


  	          <nav>
	            <h2>Categories</h2>
	            <ul>
	                <li ><a href="/misc/">misc</a></li>
	                <li ><a href="/personal/">personal</a></li>
	                <li ><a href="/programming/">programming</a></li>
	                <li ><a href="/publications/">publications</a></li>
	                <li class="active"><a href="/science/">science</a></li>
	                <li ><a href="/software/">software</a></li>
	                <li ><a href="/talks/">talks</a></li>
	            </ul>

	            <ul>
	              <li><a href="/tags.html">all tags</a></li>
	            </ul>
	          </nav>

	            <aside>
	            <h2>Social</h2>
			      <ul class="social">
				    <li><a href="http://twitter.com/agapow">Twitter</a><i></i></li>
				    <li><a href="http://github.com/agapow">Github</a><i></i></li>
				    <li><a href="https://www.linkedin.com/in/paul-agapow/">LinkedIn</a><i></i></li>
			      </ul>
			    </aside>

	            <aside>
	              <h2>Links</h2>
	              <ul>
	                  <li><a href="http://www.meetup.com/Bioinformatics-London">Bioinformatics London</a></li>
	              </ul>
	            </aside>

<a class="twitter-timeline" data-dnt="true" href="https://twitter.com/agapow" data-widget-id="336428520026812416">Tweets by @agapow</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

	        </div>
		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  Paul Agapow - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-sober">pelican-sober</a>.
    	</p>

	  </footer>

	</div>


</body>
</html>